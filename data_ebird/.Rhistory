library(knitr)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning =FALSE)
library(here)
library(tidyverse)
birds_ebird <- read_csv(paste0(here(), '/data_ebird/all-stats-regional-2021.csv'))
birds_pnas <- read_csv(paste0(here(), '/data_ebird/pnas.2023170118.sd01.csv'))
bird_e1 <- read_tsv(paste0(here(), '/e1_party-quiz/bird_key.tsv'))
foo <- filter(birds_ebird, str_detect(common_name, "Corm")
)
View(foo)
foo <- filter(foo, region_code == "USA")
View(foo)
birds_in_USA <- birds_ebird %>%
filter(region_code == "USA") %>%
mutate(normalized_sci_name = tolower(str_remove(scientific_name, " "))) %>%
select(common_name, species_code, normalized_sci_name, abundance_mean, season_name) %>%
group_by(species_code) %>%
summarize(first_abundance = first(abundance_mean), sum_abundance_mean = sum(abundance_mean, na.rm = TRUE), normalized_sci_name = first(normalized_sci_name), common_name = first(common_name), year_present = any(season_name == "year_round")) %>%
ungroup()
View(birds_in_USA)
birds_merge <- birds_pnas %>%
mutate(normalized_sci_name = tolower(str_remove(`Scientific name`, " "))) %>%
left_join(birds_in_USA)
View(birds_merge)
birds_prevalence_USA <- birds_merge %>%
filter(!is.na(species_code)) %>%
select("Common name", "Order", "Family", "Abundance estimate", "Scientific name", "normalized_sci_name", "species_code", "sum_abundance_mean") %>%
rename(common_name = `Common name`,
scientific_name = `Scientific name`,
order = Order,
family = Family,
abundance_estimate_pnas = `Abundance estimate`,
abundance_estimate_ebird = sum_abundance_mean) %>%
arrange(desc(abundance_estimate_pnas)) %>%
mutate(rank_overall = row_number()) %>%
group_by(order) %>%
mutate(rank_in_order = row_number()) %>%
ungroup() %>%
group_by(family) %>%
mutate(rank_in_family = row_number()) %>%
ungroup()
View(birds_prevalence_USA)
foo = filter(birds_in_USA, str_detect(common_name, "Corm"))
names(birds_pnas)
goo = filter(birds_pnas, str_detect(`Common name`, "Corm"))
View(goo)
View(foo)
birds_in_USA <- birds_ebird %>%
filter(region_code == "USA")
View(birds_in_USA)
